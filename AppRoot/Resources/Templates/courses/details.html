<link rel="stylesheet" href="CSS/details.css">
<script type="text/javascript" src="JS/utils.js"></script>
<script>
  var id = getQueryVariable("id");
  console.log(id);

  function enrollStudent() {
    $.ajax({
      type: "POST",
      url: "Models/ViewModels/enroll.php?id=" + id,
      success: function(data) {
        $('#enroll-btn').hide();
      }
    });
  }

  $.ajax({
    type: "POST",
    url: "Models/ViewModels/getCourseById.php?id=" + id,
    success: function(data) {
      console.log("Models/ViewModels/getCourseById.php?id=" + id);
      var obj = JSON.parse(data);
      $('#name').html(obj[0]["name"]);
      $('#description').html(obj[0]["description"]);
      $('#capacity').html("Max students count: " + obj[0]["students_capacity"]);
      $('#difficulty_level').html("Difficulty Level: " + obj[0]["difficulty"]);

      $('#edit-btn').attr("href", "edit.html?id=" + id);
      $('#delete-btn').attr("href", "delete.html?id=" + id);
    }
  });

  $.ajax({
    type: "POST",
    url: "Models/ViewModels/getLecturesByCourse.php?course=" + id,
    success: function(data){
      var obj = JSON.parse(data);
      for (var i in obj) {
        var lecture = obj[i];
        var div = $('<div class="row"></div>');
        var link = $('<div class="image"></div><div class="rows-3"><h3>' + lecture["title"] + '</h3><p>' + lecture["description"] + '</p><a href="../lectures/calendar.html?date=' + lecture["date"] + '" class="button">Learn More</a>')
        div.append(link);
        $('#lectures').append(div);
      }
    }
  });
</script>
<div class="emo">
  <h3 id="name"></h4>
  <hr>
  <p id="description"></p>
  <p id="capacity"></p>
  <p id="difficulty_level"></p>
  <hr />
  <div id="lectures">
    <h4>Лекции</h4>
  </div>
  <hr />
  <div id="operations">
    <button type="button" id="enroll-btn" onclick="enrollStudent()" class="btn btn-default">Запиши се</button>
    <hr />
    <a id="edit-btn" class="btn btn-warning">Редактирай</a>
    <a id="delete-btn" class="btn btn-danger">Изтрий</a>
  </div>
</div>
